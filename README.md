# Marking-the-planting-of-rows-of-plants-according-to-the-coordinates-of-the-maps

<a href="https://colab.research.google.com/?pli=1&authuser=1"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **–∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç** –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–µ–æ–ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Ç—Ä–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ª–∏–Ω–µ–π–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–¥–æ—Ä–æ–≥–∏, –∫–∞–±–µ–ª–∏, –ª–µ—Å—Ç–Ω–∏—Ü—ã –∏ –ø—Ä.) –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ (U-Net) –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ–¥–æ–±–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
‚îú‚îÄ‚îÄ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è_–≥–µ–æ_–¥–∞–Ω–Ω—ã—Ö.ipynb   # –ì–ª–∞–≤–Ω—ã–π Jupyter Notebook –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ data/                              # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ø–∞–ø–∫–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ tiles/                         # –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ç–∞–π–ª—ã –∫–∞—Ä—Ç
‚îÇ   ‚îî‚îÄ‚îÄ output/                        # —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –∏ csv-—Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ models/                            # —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤–µ—Å–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ (best_unet.pth)
‚îú‚îÄ‚îÄ scripts/                           # –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
‚îú‚îÄ‚îÄ README.md                          # —ç—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ LICENSE                            # –ª–∏—Ü–µ–Ω–∑–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–π–ª–æ–≤ –∫–∞—Ä—Ç**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `staticmap` –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –∏ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç —Å –∑–∞–¥–∞–Ω–Ω—ã–º —Ü–µ–Ω—Ç—Ä–æ–º –∏ —É—Ä–æ–≤–Ω–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.
2. **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç**
   - –§—É–Ω–∫—Ü–∏–∏ `latlon_to_pixel` –∏ `pixel_to_latlon` –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–µ–∫—Ü–∏–∏ Web Mercator (`pyproj`).
3. **–î–µ—Ç–µ–∫—Ü–∏—è –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è**
   - –í—ã–¥–µ–ª–µ–Ω–∏–µ –ª–∏–Ω–∏–π –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Å–≤—è–∑–µ–π —Å –ø–æ–º–æ—â—å—é `cv2` –∏ `DBSCAN` –∏–∑ `scikit-learn`.
4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω–µ—á–Ω–æ–≥–æ CSV**
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–æ–≤ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–∞–π–¥–µ–Ω–Ω–æ–π –ª–∏–Ω–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `latitude, longitude`.
5. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ U-Net**
   - –î–∞—Ç–∞—Å–µ—Ç `CVATDataset` –¥–ª—è —á—Ç–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ç–∫–∏ CVAT (.xml —Å `polyline`).
   - –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã U-Net —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ `albumentations`.
   - –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ª—É—á—à–µ–π –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤–µ—Å–æ–≤.

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **Python 3.8+**
2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

   ```bash
   pip install staticmap pyproj shapely
   pip install opencv-python torch torchvision
   pip install numpy pandas matplotlib scikit-learn
   pip install albumentations albumentations-pytorch
   ```

3. **(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)** –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Google Colab, –≤—Å–µ –ø–∞–∫–µ—Ç—ã –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ —è—á–µ–π–∫–µ:

   ```python
   !pip install staticmap pyproj shapely opencv-python torch torchvision \
               numpy pandas matplotlib scikit-learn albumentations albumentations-pytorch
   ```

## üìì –ó–∞–ø—É—Å–∫ Jupyter Notebook

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è_–≥–µ–æ_–¥–∞–Ω–Ω—ã—Ö.ipynb` –≤ –≤–∞—à–µ–π —Å—Ä–µ–¥–µ (Jupyter Lab/Notebook) –∏–ª–∏ –ø–æ –∫–Ω–æ–ø–∫–µ `Open In Colab`.
2. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —è—á–µ–π–∫–∏ —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏:
   - **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫**: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤.
   - **–ó–∞–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫**: –∏–º–ø–æ—Ä—Ç –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π.
   - **–û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥**: —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞–π–ª–æ–≤, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ CSV.
   - **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—â–µ–≥–æ CSV-—Ñ–∞–π–ª–∞**: –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –≤—Å–µ–º –æ–±–ª–∞—Å—Ç—è–º.
3. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –≤ —è—á–µ–π–∫–µ `main()` —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:
   - `center_lat`, `center_lon` ‚Äî —Ü–µ–Ω—Ç—Ä –∫–∞—Ä—Ç—ã.
   - `zoom` ‚Äî —É—Ä–æ–≤–µ–Ω—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç 15 –¥–æ 19 –¥–ª—è –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤).
   - `output_dir` ‚Äî –ø–∞–ø–∫–∞ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
   - `areas` ‚Äî —Å–ø–∏—Å–æ–∫ –æ–±–ª–∞—Å—Ç–µ–π —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ `(min_lat, min_lon, max_lat, max_lon)`.
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `main()`. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤ `output/` –ø–æ—è–≤—è—Ç—Å—è –ø–æ–¥–ø–∞–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –æ–±–ª–∞—Å—Ç–∏ —Å:
   - `tiles/` ‚Äî —Å–∫–∞—á–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
   - `lines/` ‚Äî csv —Å –≥–µ–æ–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏.
   - `ladder_connections_dbscan.csv` ‚Äî —Ç–∞–±–ª–∏—Ü–∞ —Å–æ —Å–≤—è–∑—è–º–∏ –æ–±—ä–µ–∫—Ç–æ–≤.

## üìà –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ —Ä–∞–∑–¥–µ–ª—É **–ö–æ–¥ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏** (–æ–Ω –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ `# –ö–æ–¥ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–ª–∞–±–µ)`).
2. –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç–∏:
   - `train_images_dir`, `train_annotation_file` ‚Äî –ø–∞–ø–∫–∞ —Å –æ–±—É—á–∞—é—â–∏–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ XML-—Ä–∞–∑–º–µ—Ç–∫–æ–π CVAT.
   - `val_images_dir`, `val_annotation_file` ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏.
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ `train_transform` –∏ `val_transform` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ–±—Ä–µ–∑–∫–∞ –¥–æ 512√ó512, –ø–æ–≤–æ—Ä–æ—Ç—ã, –∫–æ–Ω—Ç—Ä–∞—Å—Ç).
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `main()`, –º–æ–¥–µ–ª—å –Ω–∞—á–Ω—ë—Ç –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ GPU (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ).
5. –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –ø–æ—è–≤–∏—Ç—Å—è —Ñ–∞–π–ª `best_unet.pth` —Å –Ω–∞–∏–ª—É—á—à–∏–º–∏ –≤–µ—Å–∞–º–∏.

## üîç –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- **–ü—Ä–æ–µ–∫—Ü–∏—è –∏ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `pyproj.Transformer` –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –º–µ–∂–¥—É –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∏ Web Mercator.
- **DBSCAN**: –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–∞ –±–ª–∏–∂–∞–π—à–∏—Ö —É–∑–ª–æ–≤ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ª–∏–Ω–∏—è–º–∏ (–ª–µ—Å—Ç–Ω–∏—Ü–∞–º–∏, –¥–æ—Ä–æ–≥–∞–º–∏).
- **U-Net**: –≥–ª—É–±–æ–∫–∞—è —Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è —Å–µ—Ç—å —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π ¬´—ç–Ω–∫–æ–¥–µ—Ä‚Äì–¥–µ–∫–æ–¥–µ—Ä¬ª –∏ –ø—Ä–æ–ø—É—Å–∫–Ω—ã–º–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏.


## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **CC BY-NC-ND 4.0**. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ —Ñ–∞–π–ª–µ `LICENSE`.



